<div class="container-fluid">

  <!-- Top Title Row -->


  <div class="row g-4 ">

    <!-- LEFT SIDE BOX -->
    <div class="col-md-7 card shadow-sm border-0 rounded-4">
      <div class="d-flex align-items-center justify-content-between mx-0 mb-2">

        <!-- Left side: back icon + indent ID + status badge -->
        <div class="d-flex align-items-center">
          <i class="bi bi-chevron-left fs-4 me-2 cursor-pointer" (click)="back()"></i>
          <h5 class="fw-bold m-0">{{ indentDetailsData?.indentId }}</h5>

          <span class="badge ms-3 fw-semibold" [ngClass]="{
            'bg-success-subtle text-success': indentDetailsData?.status === 'Approved',
            'bg-danger-subtle text-danger': indentDetailsData?.status === 'Rejected',
            'bg-warning-subtle text-warning': indentDetailsData?.status !== 'Approved' && indentDetailsData?.status !== 'Rejected'
          }">
            ● {{ indentDetailsData?.status }}
          </span>
        </div>

        <!-- Right side: button -->
        <span *ngIf="indentDetailsData?.files" class="cursor-pointer text-light custom-btn small px-2 py-1 rounded" (click)="viewFile()">
          View Files
        </span>


      </div>

      <div class=" shadow-s border-0 rounded-4">
        <div class="card-bod">

          <div class="row g-3">
            <div class="col-md-6">
              <label class="form-label text-muted small">Division</label>
              <span class="form-control form-control-sm bg-light" readonly>
                {{ indentDetailsData?.division || '-' }}
              </span>
            </div>

            <div class="col-md-3">
              <label class="form-label text-muted small">Planned Budget</label>
              <span class="form-control form-control-sm bg-light">
                {{ indentDetailsData?.plannedBudget || '-' }}
              </span>
            </div>

            <div class="col-md-3">
              <label class="form-label text-muted small">Estimated Budget</label>
              <span class="form-control form-control-sm bg-light">
                {{ indentDetailsData?.estimatedBudget || '-' }}
              </span>
            </div>

            <!-- <div class="col-md-3">
              <label class="form-label text-muted small">File</label>
              <span class="form-control form-control-sm bg-light fw-semibold">
                View Files
              </span>
            </div> -->
          </div>
          <hr class="custom-hr">

          <!-- <h6 class="fw-bold mb-3">Indent Details</h6> -->

          <!-- First Row -->
          <div class="scroll-container">

            <div *ngFor="let mat of indentDetailsData?.materials; let i = index" class="mb-2">

              <!-- Header -->
              <div class="fw-semibold text-success small mb-1">
                Material {{ i + 1 }}
              </div>

              <!-- First Row -->
              <div class="row g-2 mb-1 small">
                <div class="col-4">
                  <span class="text-muted">Plant</span><br>
                  <span class="fw-medium">{{ mat?.plantName || '-' }}</span>
                </div>

                <div class="col-4">
                  <span class="text-muted">Material Type</span><br>
                  <span class="fw-medium">{{ mat?.materialType || '-' }}</span>
                </div>

                <div class="col-4">
                  <span class="text-muted">Material Type</span><br>
                  <span class="fw-medium">{{ mat?.materialType || '-' }}</span>
                </div>
              </div>

              <!-- Second Row -->
              <div class="row g-2 mb-1 small">
                <div class="col-4">
                  <span class="text-muted">Meterial Name </span><br>
                  <span class="fw-medium">{{ mat?.materialName || '-' }}</span>
                </div>

                <div class="col-4">
                  <span class="text-muted">Quantity</span><br>
                  <span class="fw-medium text-truncate d-block" title="{{ mat?.quantity }}">
                    {{ mat?.materialName || '-' }}
                  </span>
                </div>

                <div class="col-4">
                  <span class="text-muted">Unit Price</span><br>
                  <span class="fw-medium">{{ mat?.untiPrice || 0 }}</span>
                </div>
              </div>

              <div class="row g-2 mb-1 small">
                <div class="col-4">
                  <span class="text-muted">Delivery Date </span><br>
                  <span class="fw-medium">{{ mat?.deliveryDate || '-' }}</span>
                </div>

                <div class="col-4">
                  <span class="text-muted">Vendor </span><br>
                  <span class="fw-medium text-truncate d-block" title="{{ mat?.vendor }}">
                    {{ mat?.materialName || '-' }}
                  </span>
                </div>

                <div class="col-4">
                  <span class="text-muted">Comments</span><br>
                  <span class="fw-medium">{{ mat?.comments || 0 }}</span>
                </div>
              </div>

              <!-- Justification -->
              <div class="small">
                <span class="text-muted">Justification / Reason</span><br>
                <span>{{ mat?.comments || '-' }}</span>
              </div>

            </div>


          </div>



          <!-- Buttons -->
          <!-- <button *ngIf="!isEdit" class="custom-edit-btn my-3" (click)="toggleEdit()">
              Edit
            </button>


            <button *ngIf="isEdit" class="btn custom-btn px-4 my-3" (click)="saveChanges()">
              Save And Submit
            </button> -->

        </div>
      </div>
    </div>



    <!-- RIGHT SIDE: APPROVAL STATUS -->
    <div class="col-md-5">
      <div class="card shadow-sm border-0 rounded-4">
        <div class="card-body">

          <h5 class="fw-bold mb-3">Approval Status</h5>

          <table class="table table-bordered align-middle small">
            <thead class="table-light">
              <tr>
                <th width="30%">Approval Stage</th>
                <th width="35%">Parameter</th>
                <th>Comment</th>
              </tr>
            </thead>

            <tbody>

              <tr>
                <td>
                  <span class="text-dark fw-bold" style="font-weight: 600;">Manager/HOD</span><br />
                  <span class="text-success">● Approved</span><br />
                  <small>10 Nov, 2025</small>
                </td>
                <td>
                  <div class="item">Medisource Pvt. Ltd.</div>
                  <div class="item">Zen Pvt. Ltd.</div>
                </td>
                <td>
                  <span class="cursor-pointer" data-bs-toggle="tooltip" data-bs-placement="top"
                    data-bs-custom-class="custom-tooltip"
                    data-bs-title="Please review this section carefully — the current implementation may cause unexpected behavior and needs attention before moving forward.">
                    The current implementation loo....
                  </span>
                </td>
              </tr>

              <tr>
                <td>
                  <span class="text-dark fw-bold" style="font-weight: 600;">Purchase</span><br />
                  <span class="text-success">● Approved</span><br />
                  <small>10 Nov, 2025</small>
                </td>
                <td></td>
                <td></td>
              </tr>

              <tr>
                <td>
                  <span class="text-dark fw-bold" style="font-weight: 600;">SAAP</span><br />
                  <span class="text-warning">● Approved</span><br />
                  <small>--</small>
                </td>
                <td></td>
                <td></td>
              </tr>

            </tbody>
          </table>

        </div>
      </div>
    </div>

  </div>

</div>


<div *ngIf="pdfFiles.length > 0">
  <div class="mb-2">
    <label
      *ngFor="let file of pdfFiles"
      class="me-3"
    >
      <input
        type="radio"
        name="pdf"
        (change)="onFileChange(file.url)"
      />
      {{ file.name }}
    </label>
  </div>

  <iframe
    [src]="selectedFileUrl"
    width="100%"
    height="600"
    style="border: 1px solid #ccc"
  ></iframe>
</div>

